{% extends 'base.html' %}
{% load math_filters %}

{% block title %}المشاكل{% endblock %}

{% block content %}
<div class="container py-3">
  <div class="d-flex justify-content-between align-items-center mb-3">
    <ul class="nav nav-pills">
      <li class="nav-item"><a class="nav-link" href="{% url 'super_owner_dashboard' %}">لوحة الإدارة</a></li>
      <li class="nav-item"><a class="nav-link" href="{% url 'super_owner_reports' %}">التقارير</a></li>
      <li class="nav-item"><a class="nav-link active" href="{% url 'super_owner_issues' %}">المشاكل</a></li>
    </ul>
    <div class="rounded-circle {% if system_status == 'Critical' %}bg-danger{% elif system_status == 'Warning' %}bg-warning{% else %}bg-success{% endif %}" style="width:24px;height:24px">
      <span class="visually-hidden">{{ system_status }}</span>
    </div>
  </div>

  {% if alert_count > 0 %}
  <div class="row g-4">
    {% for a in critical_alerts %}
      <div class="col-lg-3 col-md-6">
        <div class="card {% if a.type == 'pending_orders_over_24h' or a.type == 'delivery_failure' %}bg-dark text-danger{% elif a.type == 'inactive_stores' %}bg-dark text-warning{% else %}bg-dark text-warning{% endif %} p-4 text-center">
          <i class="bi bi-exclamation-triangle fs-2 mb-2"></i>
          <div class="fs-6 mb-1">{{ a.label }}</div>
          <div class="fs-2 fw-bold">{{ a.count }}</div>
          <div class="mt-3">
            <a href="{% url a.url %}" class="btn btn-outline-light btn-sm">الانتقال للإدارة</a>
          </div>
        </div>
      </div>
    {% endfor %}
  </div>
  {% else %}
  <div class="card bg-dark text-success p-4 text-center">
    <div class="fs-5">لا توجد مشاكل حالية</div>
  </div>
  {% endif %}
</div>
{% endblock %}
