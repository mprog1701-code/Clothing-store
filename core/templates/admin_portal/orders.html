<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>طلبات الإدارة</title>
  <link rel="stylesheet" href="/static/css/style.css">
  <link rel="stylesheet" href="/static/css/theme-hotfix.css">
  <link rel="stylesheet" href="/static/css/admin-mobile.css?v=1">
</head>
<body class="is-admin" data-path="{{ request.path }}">
  <div class="container" style="max-width:1200px;margin:20px auto;">
    <h2>الطلبات</h2>
    <nav>
      <a href="/admin-portal/dashboard/">لوحة التحكم</a> |
      <a href="/admin-portal/orders/">الطلبات</a> |
      <a href="/admin-portal/products/">المنتجات</a> |
      <a href="/admin-portal/stores/">المتاجر</a> |
      <a href="/admin-portal/customers/">العملاء</a> |
      <a href="/admin-portal/settings/">الإعدادات</a>
    </nav>
    <hr>
    {% if messages %}
      {% for message in messages %}
        <div class="alert alert-{{ message.tags }}">{{ message }}</div>
      {% endfor %}
    {% endif %}

    <div class="table-responsive admin-table-wrap">
    <table class="table admin-table">
      <thead>
        <tr>
          <th>#</th>
          <th>المستخدم</th>
          <th>المتجر</th>
          <th>الحالة</th>
          <th>المبلغ</th>
          <th>تاريخ الإنشاء</th>
          <th>تعديل الحالة</th>
        </tr>
      </thead>
      <tbody>
        {% for o in orders %}
        <tr>
          <td data-label="#">{{ o.id }}</td>
          <td data-label="المستخدم">{{ o.user.username }}</td>
          <td data-label="المتجر">{{ o.store.name }}</td>
          <td data-label="الحالة">{{ o.status }}</td>
          <td data-label="المبلغ">{{ o.total_amount }}</td>
          <td data-label="تاريخ الإنشاء">{{ o.created_at }}</td>
          <td data-label="تعديل الحالة">
            <form method="post" style="display:flex;gap:8px;align-items:center;">
              {% csrf_token %}
              <input type="hidden" name="order_id" value="{{ o.id }}">
              <select name="status" class="form-select">
                <option value="pending" {% if o.status == 'pending' %}selected{% endif %}>قيد الانتظار</option>
                <option value="accepted" {% if o.status == 'accepted' %}selected{% endif %}>تم القبول</option>
                <option value="preparing" {% if o.status == 'preparing' %}selected{% endif %}>قيد التجهيز</option>
                <option value="on_the_way" {% if o.status == 'on_the_way' %}selected{% endif %}>في الطريق</option>
                <option value="delivered" {% if o.status == 'delivered' %}selected{% endif %}>تم التسليم</option>
                <option value="canceled" {% if o.status == 'canceled' %}selected{% endif %}>ملغي</option>
              </select>
              <button type="submit" class="btn btn-sm btn-primary">تحديث</button>
            </form>
          </td>
        </tr>
        {% empty %}
        <tr>
          <td colspan="7" style="text-align:center;">لا توجد طلبات</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
    </div>
  </div>
 </body>
</html>
